# -*- coding: utf-8 -*-
"""submarine

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1ZMLSmQ1rZIraDkP3jrAc1KRLSx96vV6Y
"""

from sklearn.linear_model import LogisticRegression
from sklearn.preprocessing import StandardScaler
from sklearn.model_selection import train_test_split
import numpy as np
import pandas as pd
from sklearn.preprocessing import PolynomialFeatures
import seaborn as sns

str=PolynomialFeatures(degree=2,include_bias=False,interaction_only=True)
p=str.fit_transform(x)
p.shape

di=pd.read_csv('/content/Copy of sonar data.csv')
di.head()

x=di.drop('R',axis=1)

x.shape

y=di['R']

s=StandardScaler()

fet=s.fit_transform(x)

l=LogisticRegression()

xtr,xte,ytr,yte=train_test_split(p,y,test_size=0.2,stratify=y,random_state=1)

mod=l.fit(xtr,ytr)

c=mod.predict(xtr)

c

p.shape

yte

from sklearn.metrics import accuracy_score

v=accuracy_score(ytr,c)

v

m=[[
0.0258,0.0433,0.0547,0.0681,0.0784,0.1250,0.1296,0.1729,0.2794,0.2954,0.2506,0.2601,0.2249,0.2115,0.1270,0.1193,0.1794,0.2185,0.1646,0.0740,0.0625,0.2381,0.4824,0.6372,0.7531,0.8959,0.9941,0.9957,0.9328,0.9344,0.8854,0.7690,0.6865,0.6390,0.6378,0.6629,0.5983,0.4565,0.3129,0.4158,0.4325,0.4031,0.4201,0.4557,0.3955,0.2966,0.2095,0.1558,0.0884,0.0265,0.0121,0.0091,0.0062,0.0019,0.0045,0.0079,0.0031,0.0063,0.0048,0.0050]]

d=s.fit_transform(e)

d

k=[[
0.0409,0.0421,0.0573,0.0130,0.0183,0.1019,0.1054,0.1070,0.2302,0.2259,0.2373,0.3323,0.3827,0.4840,0.6812,0.7555,0.9522,0.9826,0.8871,0.8268,0.7561,0.8217,0.6967,0.6444,0.6948,0.8014,0.6053,0.6084,0.8877,0.8557,0.5563,0.2897,0.3638,0.4786,0.2908,0.0899,0.2043,0.1707,0.0407,0.1286,0.1581,0.2191,0.1701,0.0971,0.2217,0.2732,0.1874,0.1062,0.0665,0.0405,0.0113,0.0028,0.0036,0.0105,0.0120,0.0087,0.0061,0.0061,0.0030,0.0078]]

e=s.fit_transform(k)

e